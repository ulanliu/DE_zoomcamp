[2022-11-26 07:48:49,878] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: LocalIngestationDag_new.ingestation scheduled__2021-02-02T06:00:00+00:00 [queued]>
[2022-11-26 07:48:49,944] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: LocalIngestationDag_new.ingestation scheduled__2021-02-02T06:00:00+00:00 [queued]>
[2022-11-26 07:48:49,946] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2022-11-26 07:48:49,947] {taskinstance.py:1239} INFO - Starting attempt 2 of 2
[2022-11-26 07:48:49,948] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2022-11-26 07:48:50,016] {taskinstance.py:1259} INFO - Executing <Task(PythonOperator): ingestation> on 2021-02-02 06:00:00+00:00
[2022-11-26 07:48:50,032] {standard_task_runner.py:52} INFO - Started process 4127 to run task
[2022-11-26 07:48:50,047] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'LocalIngestationDag_new', 'ingestation', 'scheduled__2021-02-02T06:00:00+00:00', '--job-id', '104', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestation.py', '--cfg-path', '/tmp/tmpbtgm81tk', '--error-file', '/tmp/tmpyza0azmv']
[2022-11-26 07:48:50,051] {standard_task_runner.py:77} INFO - Job 104: Subtask ingestation
[2022-11-26 07:48:50,237] {logging_mixin.py:109} INFO - Running <TaskInstance: LocalIngestationDag_new.ingestation scheduled__2021-02-02T06:00:00+00:00 [running]> on host 951f10ff76c7
[2022-11-26 07:48:50,455] {logging_mixin.py:109} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:152 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2022-11-26 07:48:50,518] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=LocalIngestationDag_new
AIRFLOW_CTX_TASK_ID=ingestation
AIRFLOW_CTX_EXECUTION_DATE=2021-02-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-02-02T06:00:00+00:00
[2022-11-26 07:48:50,523] {logging_mixin.py:109} INFO - yellow_taxi_2021_02 /opt/***/output_2021-02.parquet 2021-02-02T06:00:00+00:00
[2022-11-26 07:48:50,524] {logging_mixin.py:109} INFO - 3.7.12
[2022-11-26 07:48:50,525] {logging_mixin.py:109} INFO - 1.3.5
[2022-11-26 07:48:50,529] {logging_mixin.py:109} INFO - connection established successfully, inserting data...
[2022-11-26 07:50:37,618] {logging_mixin.py:109} INFO - inserted another chunk, took 104.283 second
[2022-11-26 07:52:32,539] {logging_mixin.py:109} INFO - inserted another chunk, took 114.829 second
[2022-11-26 07:54:23,672] {logging_mixin.py:109} INFO - inserted another chunk, took 111.041 second
[2022-11-26 07:56:10,903] {logging_mixin.py:109} INFO - inserted another chunk, took 106.979 second
[2022-11-26 08:07:35,062] {logging_mixin.py:109} INFO - inserted another chunk, took 684.059 second
[2022-11-26 10:39:18,482] {local_task_job.py:212} WARNING - State of this instance has been externally set to failed. Terminating instance.
[2022-11-26 10:39:18,776] {process_utils.py:124} INFO - Sending Signals.SIGTERM to group 4127. PIDs of all processes in the group: [4127]
[2022-11-26 10:39:18,805] {process_utils.py:75} INFO - Sending the signal Signals.SIGTERM to group 4127
[2022-11-26 10:39:18,848] {taskinstance.py:1408} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-11-26 10:39:19,771] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1204, in _execute_context
    context = constructor(dialect, self, conn, *args)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 816, in _init_compiled
    for grp, m in enumerate(parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 816, in <listcomp>
    for grp, m in enumerate(parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/compiler.py", line 717, in construct_params
    pd[name] = params[bindparam.key]
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1410, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 174, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 185, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/ingest_script.py", line 27, in ingest_callable
    df.to_sql(name=table_name, con=engine, if_exists='append')
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1011, in execute
    return meth(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 298, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1130, in _execute_clauseelement
    distilled_params,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1207, in _execute_context
    e, util.text_type(statement), parameters, None, None
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1511, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 182, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1204, in _execute_context
    context = constructor(dialect, self, conn, *args)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 816, in _init_compiled
    for grp, m in enumerate(parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 816, in <listcomp>
    for grp, m in enumerate(parameters)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/compiler.py", line 717, in construct_params
    pd[name] = params[bindparam.key]
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1410, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
sqlalchemy.exc.StatementError: (***.exceptions.AirflowException) Task received SIGTERM signal
[SQL: INSERT INTO yellow_taxi_2021_02 (index, "VendorID", tpep_pickup_datetime, tpep_dropoff_datetime, passenger_count, trip_distance, "RatecodeID", store_and_fwd_flag, "PULocationID", "DOLocationID", payment_type, fare_amount, extra, mta_tax, tip_amount, tolls_amount, improvement_surcharge, total_amount, congestion_surcharge, airport_fee) VALUES (%(index)s, %(VendorID)s, %(tpep_pickup_datetime)s, %(tpep_dropoff_datetime)s, %(passenger_count)s, %(trip_distance)s, %(RatecodeID)s, %(store_and_fwd_flag)s, %(PULocationID)s, %(DOLocationID)s, %(payment_type)s, %(fare_amount)s, %(extra)s, %(mta_tax)s, %(tip_amount)s, %(tolls_amount)s, %(improvement_surcharge)s, %(total_amount)s, %(congestion_surcharge)s, %(airport_fee)s)]
[parameters: [{'index': 0, 'VendorID': 1, 'tpep_pickup_datetime': datetime.datetime(2021, 2, 12, 15, 43, 36), 'tpep_dropoff_datetime': datetime.datetime(2021, 2, 1 ... (51538978 characters truncated) ... ': 0.5, 'tip_amount': 0.0, 'tolls_amount': 0.0, 'improvement_surcharge': 0.3, 'total_amount': 29.3, 'congestion_surcharge': 2.5, 'airport_fee': None}]]
[2022-11-26 12:04:27,204] {taskinstance.py:1277} INFO - Marking task as FAILED. dag_id=LocalIngestationDag_new, task_id=ingestation, execution_date=20210202T060000, start_date=20221126T074849, end_date=20221126T120427
[2022-11-26 13:21:52,073] {process_utils.py:138} WARNING - process psutil.Process(pid=4127, name='airflow task ru', status='running', started='07:48:49') did not respond to SIGTERM. Trying SIGKILL
[2022-11-26 13:21:52,120] {process_utils.py:75} INFO - Sending the signal Signals.SIGKILL to group 4127
[2022-11-26 13:21:55,166] {process_utils.py:70} INFO - Process psutil.Process(pid=4127, name='airflow task ru', status='terminated', exitcode=<Negsignal.SIGKILL: -9>, started='07:48:49') (4127) terminated with exit code Negsignal.SIGKILL
[2022-11-26 13:21:55,171] {standard_task_runner.py:135} ERROR - Job 104 was killed before it finished (likely due to running out of memory)
[2022-11-26 13:22:06,720] {local_task_job.py:142} ERROR - Heartbeat time limit exceeded!
